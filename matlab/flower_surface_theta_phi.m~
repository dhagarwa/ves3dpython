function [] = flower_surface_theta_phi()
    %Function to generate the flower surface
    % r = [psin(u)cos(v);psin(u)sin(v);pcos(u)]
    % p = 1 + exp(-3 Real(Y(3,2,u,v))), u \in [0,pi], v \in [0,2*pi]
    rootdir = '/Users/dhwanit/Google Drive/Biros Research/ves3dpython/matlab';
    relativefolder = 'testfiles';
    fid = fopen(fullfile(rootdir, relativefolder, 'matlab_test_SL_targets.txt'), 'rt');
    C = textscan(fid,'%f');
    fclose(fid);
    %celldisp(C);
    A = cell2mat(C);
    m0 = size(A, 1);
    all_trg = reshape(A, [m0/3, 3]);

    rootdir = '/Users/dhwanit/Google Drive/Biros Research/ves3dpython/matlab';
    relativefolder = 'testfiles';
    fid = fopen(fullfile(rootdir, relativefolder, 'matlab_test_SL_potential.txt'), 'rt');
    C = textscan(fid,'%f');
    fclose(fid);
    %celldisp(C);
    A = cell2mat(C);
    m0 = size(A, 1);
    all_pot = reshape(A, [m0/3, 3]);
    u = u(:);
    v = v(:);
    
    r = flower_function(u,v);
    scatter3(r(:,1),r(:,2),r(:,3));
    r = r(:); %C++ src corrdinate form
    
    %write r to text file
    dlmwrite('flower_src.txt',r,'newline','pc');
end

